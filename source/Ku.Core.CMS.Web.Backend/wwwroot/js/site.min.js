function _action(n,t,i,r){var u=t.indexOf(":")>0?t.substring(0,t.indexOf(":")):"",f=t.indexOf(":")>0?t.substring(t.indexOf(":")+1):"",e=[],o,c,l,s,h,a;if(f.indexOf("[")>=0&&(e=eval(f.substring(f.indexOf("["),f.indexOf("]")+1)),f=f.substring(0,f.indexOf("["))),u==="window")OpenWindow($(n).attr("title")||"&nbsp;",f,null,function(t){i&&_action(n,i,null,t)});else if(u==="javascript"||u==="js")eval("var $this;"),eval("var $data;"),$this=n,$data=r,eval(f);else if(u==="post"||u==="get"||u==="ajax-get"||u==="ajax-post"||u==="ajax-delete")o=t.indexOf(":")>0?t.substring(t.indexOf(":")+1):"",c=`确定要进行${$(n).attr("title")||"当前"}操作？`,ku.page.msg.confirm(c,function(){("get"===u||"ajax-get"===u)&&ku.ajax.get(o,r||null,function(t){t.code===0?ku.page.msg.tip("操作成功！",function(){i&&_action(n,i,null,t)}):ku.page.msg.tip(t.message)});"post"===u||"ajax-post"===u?ku.ajax.post(o,r||null,function(t){t.code===0?ku.page.msg.tip("操作成功！",function(){i&&_action(n,i,null,t)}):ku.page.msg.tip(t.message)}):ku.ajax.delete(o,r||null,function(t){t.code===0?ku.page.msg.tip("操作成功！",function(){i&&_action(n,i,null,t)}):ku.page.msg.tip(t.message)})});else if(u==="grid")"reload"===f&&(e.length>0?$(e[0]).kuGrid("reload"):$(".ku-grid").kuGrid("reload"));else if(u==="batch"){if(l=e[0],s=$(l).kuGrid("getCheckedIds"),!s||s.length==0){ku.page.msg.tip("请至少选择一项！");return}_action(n,e[1],i,{id:s})}else u==="tab"?(h=e[0],e.length===1&&_openTab(h),a={id:h,title:e[1],url:e[2],reload:e[3]},_openTab(h,a)):t&&ku.page.navigateTo(t)}function _openTab(n,t){self!=top?parent._openTab(n,t):openTab(n,t)}function _bindForm(n,t){var t=$.extend({},{onSuccess:function(n){ku.page.msg.tip("保存成功！",function(){var t,i;_isWindow()?(t=parent.layer.getFrameIndex(window.name),parent.layer.close(t),i=parent.winfns[t],i&&i(n),parent.winfns[t]=null):location.reload()})}},t);n.kuForm(t)}function _isWindow(){return $("body :first").hasClass("layui-layout-window")}function OpenWindow(n,t,i,r){if(self!=top)parent.OpenWindow(n,t,i,r);else{var u=$.extend({},{area:["900px","550px"],shade:.3,maxmin:!0},i);layui.use(["layer"],function(){var i=layui.layer,f=i.open({type:2,title:n,area:u.area,shade:u.shade,maxmin:u.maxmin,content:t,zIndex:i.zIndex,success:function(n){i.setTop(n)}});window.winfns[f]=r})}}layui.config({base:"/lib/layui-modules/"});layui.use(["element","form","layer","laydate"],function(){var n=layui.jquery,t=layui.layer,i=layui.element,r=layui.form;n(document).on("click","button.layui-btn:not([lay-submit]):not([action-ignore]), .layui-action",function(){var t=n(this).data("action")||n(this).attr("action")||"",i=n(this).attr("after");_action(this,t,i)});n("form[auto-bind=true]").each(function(){_bindForm(n(this))});n(".layui-input.laydate").each(function(){var t=n(this),i=t.data("type")||"date",r=t.data("format")||"yyyy-MM-dd";laydate.render({elem:t[0],type:i,format:r})})});window.winfns||(window.winfns={});